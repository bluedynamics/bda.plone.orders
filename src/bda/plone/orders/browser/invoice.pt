<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="bda.plone.orders">

<body>

<metal:main fill-slot="main">
  <tal:main-macro metal:define-macro="main">

    <div class="invoice"
         tal:define="sender view/sender;
                     order view/order">

      <h1 class="invoice_title"
          i18n:translate="your_invoice">Your Invoice</h1>

      <div class="invoice_sender">
        <strong tal:content="sender/title">title</strong>
        <br />
        <tal:subtitle condition="sender/subtitle">
          <span tal:replace="sender/subtitle">subtitle</span>
          <br />
        </tal:subtitle>
        <br />
        <span tal:replace="sender/firstname">first name</span>
        <span tal:replace="sender/lastname">last name</span>
        <br />
        <span tal:replace="sender/street">street</span>
        <br />
        <span tal:replace="sender/zip">zip</span>
        <span tal:replace="sender/city">city</span>
        <br />
        <span tal:replace="python:view.country(sender['country'])">
          country
        </span>
        <br />
        <tal:phone condition="sender/phone">
          <span tal:replace="sender/phone">phone</span>
          <br />
        </tal:phone>
        <tal:email condition="sender/email">
          <span tal:replace="sender/email">email</span>
          <br />
        </tal:email>
        <tal:web condition="sender/web">
          <span tal:replace="sender/web">web</span>
          <br />
        </tal:web>
      </div>

      <div class="invoice_receiver">
        <span tal:replace="order/personal_data.firstname">first name</span>
        <span tal:replace="order/personal_data.lastname">last name</span>
        <br />
        <tal:company condition="order/personal_data.company">
          <span tal:replace="order/personal_data.company">company</span>
          <br />
        </tal:company>
        <span tal:replace="order/billing_address.street">street</span>
        <br />
        <span tal:replace="order/billing_address.zip">zip</span>
        <span tal:replace="order/billing_address.city">city</span>
        <br />
        <span tal:replace="python:view.country(order['billing_address.country'])">
          country
        </span>
      </div>

      <h2 class="invoice_number">
        <span i18n:translate="invoice">Invoice</span>
        <span tal:replace="view/invoice_number">INV12345</span>
      </h2>

      <h3 class="invoice_date">
        <span tal:replace="sender/city">city</span>,
        <span tal:replace="view/created">date</span>
      </h3>

      <div class="invoice_listing">
        <div class="invoice_listing_head">
          <div class="invoice_listing_amount">
            <strong i18n:translate="invoice_listing_amount">Amount</strong>
          </div>
          <div class="invoice_listing_position">
            <strong i18n:translate="invoice_listing_position">Position</strong>
          </div>
          <div class="invoice_listing_price">
            <strong i18n:translate="invoice_listing_price">Price</strong>
          </div>
        </div>

        <tal:item repeat="item view/listing">
          <div class="invoice_listing_item">
            <div class="invoice_listing_amount">
              <span tal:replace="item/count">count</span>
              <span tal:replace="item/quantity_unit">quantity</span>
            </div>

            <div class="invoice_listing_position">
              <span tal:replace="item/title">title</span>
              <tal:comment condition="item/comment">
                (<span tal:replace="item/comment">comment</span>)
              </tal:comment>
            </div>

            <div class="invoice_listing_price">
              <tal:without_discount condition="not:item/discount_net">
                <tal:price replace="python:view.ascur(item['net'])" />
                <tal:currency replace="item/currency" />
              </tal:without_discount>

              <tal:with_discount condition="item/discount_net">
                <span class="original_price">
                  <tal:price replace="python:view.ascur(item['net'])" />
                  <tal:currency replace="item/currency" />
                </span>
                <tal:price replace="python:view.ascur(item['net'] - item['discount_net'])" />
                <tal:currency replace="item/currency" />
              </tal:with_discount>
            </div>
          </div>
        </tal:item>
      </div>

    </div>

  </tal:main-macro>
</metal:main>

</body>
</html>
